<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>LADS/js/utils/CryptoJS/components/aes.js - Touch Art Gallery web application</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../../LADS/images/WideLogo.scale-100.png" title="Touch Art Gallery web application"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Autolinker.html">Autolinker</a></li>
            
                <li><a href="../classes/CryptoJS.html">CryptoJS</a></li>
            
                <li><a href="../classes/LADS.AnnotatedImage.html">LADS.AnnotatedImage</a></li>
            
                <li><a href="../classes/LADS.Layout.Artmode.html">LADS.Layout.Artmode</a></li>
            
                <li><a href="../classes/LADS.Layout.InternetFailurePage.js.html">LADS.Layout.InternetFailurePage.js</a></li>
            
                <li><a href="../classes/LADS.Layout.NewCatalog.html">LADS.Layout.NewCatalog</a></li>
            
                <li><a href="../classes/LADS.Layout.StartPage.html">LADS.Layout.StartPage</a></li>
            
                <li><a href="../classes/LADS.Layout.VideoPlayer.html">LADS.Layout.VideoPlayer</a></li>
            
                <li><a href="../classes/LADS.Util.Artwork.html">LADS.Util.Artwork</a></li>
            
                <li><a href="../classes/TAG_embed.html">TAG_embed</a></li>
            
                <li><a href="../classes/Telemetry.html">Telemetry</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: LADS/js/utils/CryptoJS/components/aes.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
(function () {
    // Shortcuts
    var C = CryptoJS;
    var C_lib = C.lib;
    var BlockCipher = C_lib.BlockCipher;
    var C_algo = C.algo;

    // Lookup tables
    var SBOX = [];
    var INV_SBOX = [];
    var SUB_MIX_0 = [];
    var SUB_MIX_1 = [];
    var SUB_MIX_2 = [];
    var SUB_MIX_3 = [];
    var INV_SUB_MIX_0 = [];
    var INV_SUB_MIX_1 = [];
    var INV_SUB_MIX_2 = [];
    var INV_SUB_MIX_3 = [];

    // Compute lookup tables
    (function () {
        // Compute double table
        var d = [];
        for (var i = 0; i &lt; 256; i++) {
            if (i &lt; 128) {
                d[i] = i &lt;&lt; 1;
            } else {
                d[i] = (i &lt;&lt; 1) ^ 0x11b;
            }
        }

        // Walk GF(2^8)
        var x = 0;
        var xi = 0;
        for (var i = 0; i &lt; 256; i++) {
            // Compute sbox
            var sx = xi ^ (xi &lt;&lt; 1) ^ (xi &lt;&lt; 2) ^ (xi &lt;&lt; 3) ^ (xi &lt;&lt; 4);
            sx = (sx &gt;&gt;&gt; 8) ^ (sx &amp; 0xff) ^ 0x63;
            SBOX[x] = sx;
            INV_SBOX[sx] = x;

            // Compute multiplication
            var x2 = d[x];
            var x4 = d[x2];
            var x8 = d[x4];

            // Compute sub bytes, mix columns tables
            var t = (d[sx] * 0x101) ^ (sx * 0x1010100);
            SUB_MIX_0[x] = (t &lt;&lt; 24) | (t &gt;&gt;&gt; 8);
            SUB_MIX_1[x] = (t &lt;&lt; 16) | (t &gt;&gt;&gt; 16);
            SUB_MIX_2[x] = (t &lt;&lt; 8)  | (t &gt;&gt;&gt; 24);
            SUB_MIX_3[x] = t;

            // Compute inv sub bytes, inv mix columns tables
            var t = (x8 * 0x1010101) ^ (x4 * 0x10001) ^ (x2 * 0x101) ^ (x * 0x1010100);
            INV_SUB_MIX_0[sx] = (t &lt;&lt; 24) | (t &gt;&gt;&gt; 8);
            INV_SUB_MIX_1[sx] = (t &lt;&lt; 16) | (t &gt;&gt;&gt; 16);
            INV_SUB_MIX_2[sx] = (t &lt;&lt; 8)  | (t &gt;&gt;&gt; 24);
            INV_SUB_MIX_3[sx] = t;

            // Compute next counter
            if (!x) {
                x = xi = 1;
            } else {
                x = x2 ^ d[d[d[x8 ^ x2]]];
                xi ^= d[d[xi]];
            }
        }
    }());

    // Precomputed Rcon lookup
    var RCON = [0x00, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36];

    /**
     * AES block cipher algorithm.
     */
    var AES = C_algo.AES = BlockCipher.extend({
        _doReset: function () {
            // Shortcuts
            var key = this._key;
            var keyWords = key.words;
            var keySize = key.sigBytes / 4;

            // Compute number of rounds
            var nRounds = this._nRounds = keySize + 6

            // Compute number of key schedule rows
            var ksRows = (nRounds + 1) * 4;

            // Compute key schedule
            var keySchedule = this._keySchedule = [];
            for (var ksRow = 0; ksRow &lt; ksRows; ksRow++) {
                if (ksRow &lt; keySize) {
                    keySchedule[ksRow] = keyWords[ksRow];
                } else {
                    var t = keySchedule[ksRow - 1];

                    if (!(ksRow % keySize)) {
                        // Rot word
                        t = (t &lt;&lt; 8) | (t &gt;&gt;&gt; 24);

                        // Sub word
                        t = (SBOX[t &gt;&gt;&gt; 24] &lt;&lt; 24) | (SBOX[(t &gt;&gt;&gt; 16) &amp; 0xff] &lt;&lt; 16) | (SBOX[(t &gt;&gt;&gt; 8) &amp; 0xff] &lt;&lt; 8) | SBOX[t &amp; 0xff];

                        // Mix Rcon
                        t ^= RCON[(ksRow / keySize) | 0] &lt;&lt; 24;
                    } else if (keySize &gt; 6 &amp;&amp; ksRow % keySize == 4) {
                        // Sub word
                        t = (SBOX[t &gt;&gt;&gt; 24] &lt;&lt; 24) | (SBOX[(t &gt;&gt;&gt; 16) &amp; 0xff] &lt;&lt; 16) | (SBOX[(t &gt;&gt;&gt; 8) &amp; 0xff] &lt;&lt; 8) | SBOX[t &amp; 0xff];
                    }

                    keySchedule[ksRow] = keySchedule[ksRow - keySize] ^ t;
                }
            }

            // Compute inv key schedule
            var invKeySchedule = this._invKeySchedule = [];
            for (var invKsRow = 0; invKsRow &lt; ksRows; invKsRow++) {
                var ksRow = ksRows - invKsRow;

                if (invKsRow % 4) {
                    var t = keySchedule[ksRow];
                } else {
                    var t = keySchedule[ksRow - 4];
                }

                if (invKsRow &lt; 4 || ksRow &lt;= 4) {
                    invKeySchedule[invKsRow] = t;
                } else {
                    invKeySchedule[invKsRow] = INV_SUB_MIX_0[SBOX[t &gt;&gt;&gt; 24]] ^ INV_SUB_MIX_1[SBOX[(t &gt;&gt;&gt; 16) &amp; 0xff]] ^
                                               INV_SUB_MIX_2[SBOX[(t &gt;&gt;&gt; 8) &amp; 0xff]] ^ INV_SUB_MIX_3[SBOX[t &amp; 0xff]];
                }
            }
        },

        encryptBlock: function (M, offset) {
            this._doCryptBlock(M, offset, this._keySchedule, SUB_MIX_0, SUB_MIX_1, SUB_MIX_2, SUB_MIX_3, SBOX);
        },

        decryptBlock: function (M, offset) {
            // Swap 2nd and 4th rows
            var t = M[offset + 1];
            M[offset + 1] = M[offset + 3];
            M[offset + 3] = t;

            this._doCryptBlock(M, offset, this._invKeySchedule, INV_SUB_MIX_0, INV_SUB_MIX_1, INV_SUB_MIX_2, INV_SUB_MIX_3, INV_SBOX);

            // Inv swap 2nd and 4th rows
            var t = M[offset + 1];
            M[offset + 1] = M[offset + 3];
            M[offset + 3] = t;
        },

        _doCryptBlock: function (M, offset, keySchedule, SUB_MIX_0, SUB_MIX_1, SUB_MIX_2, SUB_MIX_3, SBOX) {
            // Shortcut
            var nRounds = this._nRounds;

            // Get input, add round key
            var s0 = M[offset]     ^ keySchedule[0];
            var s1 = M[offset + 1] ^ keySchedule[1];
            var s2 = M[offset + 2] ^ keySchedule[2];
            var s3 = M[offset + 3] ^ keySchedule[3];

            // Key schedule row counter
            var ksRow = 4;

            // Rounds
            for (var round = 1; round &lt; nRounds; round++) {
                // Shift rows, sub bytes, mix columns, add round key
                var t0 = SUB_MIX_0[s0 &gt;&gt;&gt; 24] ^ SUB_MIX_1[(s1 &gt;&gt;&gt; 16) &amp; 0xff] ^ SUB_MIX_2[(s2 &gt;&gt;&gt; 8) &amp; 0xff] ^ SUB_MIX_3[s3 &amp; 0xff] ^ keySchedule[ksRow++];
                var t1 = SUB_MIX_0[s1 &gt;&gt;&gt; 24] ^ SUB_MIX_1[(s2 &gt;&gt;&gt; 16) &amp; 0xff] ^ SUB_MIX_2[(s3 &gt;&gt;&gt; 8) &amp; 0xff] ^ SUB_MIX_3[s0 &amp; 0xff] ^ keySchedule[ksRow++];
                var t2 = SUB_MIX_0[s2 &gt;&gt;&gt; 24] ^ SUB_MIX_1[(s3 &gt;&gt;&gt; 16) &amp; 0xff] ^ SUB_MIX_2[(s0 &gt;&gt;&gt; 8) &amp; 0xff] ^ SUB_MIX_3[s1 &amp; 0xff] ^ keySchedule[ksRow++];
                var t3 = SUB_MIX_0[s3 &gt;&gt;&gt; 24] ^ SUB_MIX_1[(s0 &gt;&gt;&gt; 16) &amp; 0xff] ^ SUB_MIX_2[(s1 &gt;&gt;&gt; 8) &amp; 0xff] ^ SUB_MIX_3[s2 &amp; 0xff] ^ keySchedule[ksRow++];

                // Update state
                s0 = t0;
                s1 = t1;
                s2 = t2;
                s3 = t3;
            }

            // Shift rows, sub bytes, add round key
            var t0 = ((SBOX[s0 &gt;&gt;&gt; 24] &lt;&lt; 24) | (SBOX[(s1 &gt;&gt;&gt; 16) &amp; 0xff] &lt;&lt; 16) | (SBOX[(s2 &gt;&gt;&gt; 8) &amp; 0xff] &lt;&lt; 8) | SBOX[s3 &amp; 0xff]) ^ keySchedule[ksRow++];
            var t1 = ((SBOX[s1 &gt;&gt;&gt; 24] &lt;&lt; 24) | (SBOX[(s2 &gt;&gt;&gt; 16) &amp; 0xff] &lt;&lt; 16) | (SBOX[(s3 &gt;&gt;&gt; 8) &amp; 0xff] &lt;&lt; 8) | SBOX[s0 &amp; 0xff]) ^ keySchedule[ksRow++];
            var t2 = ((SBOX[s2 &gt;&gt;&gt; 24] &lt;&lt; 24) | (SBOX[(s3 &gt;&gt;&gt; 16) &amp; 0xff] &lt;&lt; 16) | (SBOX[(s0 &gt;&gt;&gt; 8) &amp; 0xff] &lt;&lt; 8) | SBOX[s1 &amp; 0xff]) ^ keySchedule[ksRow++];
            var t3 = ((SBOX[s3 &gt;&gt;&gt; 24] &lt;&lt; 24) | (SBOX[(s0 &gt;&gt;&gt; 16) &amp; 0xff] &lt;&lt; 16) | (SBOX[(s1 &gt;&gt;&gt; 8) &amp; 0xff] &lt;&lt; 8) | SBOX[s2 &amp; 0xff]) ^ keySchedule[ksRow++];

            // Set output
            M[offset]     = t0;
            M[offset + 1] = t1;
            M[offset + 2] = t2;
            M[offset + 3] = t3;
        },

        keySize: 256/32
    });

    /**
     * Shortcut functions to the cipher&#x27;s object interface.
     *
     * @example
     *
     *     var ciphertext = CryptoJS.AES.encrypt(message, key, cfg);
     *     var plaintext  = CryptoJS.AES.decrypt(ciphertext, key, cfg);
     */
    C.AES = BlockCipher._createHelper(AES);
}());

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
