<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>TAG/js/Autolinker.js-master/src/Autolinker.js - Touch Art Gallery web application</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../../TAG/images/WideLogo.scale-100.png" title="Touch Art Gallery web application"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Autolinker.html">Autolinker</a></li>
            
                <li><a href="../classes/TAG.AnnotatedImage.html">TAG.AnnotatedImage</a></li>
            
                <li><a href="../classes/TAG.Layout.ArtworkViewer.html">TAG.Layout.ArtworkViewer</a></li>
            
                <li><a href="../classes/TAG.Layout.CollectionsPage.html">TAG.Layout.CollectionsPage</a></li>
            
                <li><a href="../classes/TAG.Layout.InternetFailurePage.js.html">TAG.Layout.InternetFailurePage.js</a></li>
            
                <li><a href="../classes/TAG.Layout.StartPage.html">TAG.Layout.StartPage</a></li>
            
                <li><a href="../classes/TAG.Layout.VideoPlayer.html">TAG.Layout.VideoPlayer</a></li>
            
                <li><a href="../classes/TAG.Util.Artwork.html">TAG.Util.Artwork</a></li>
            
                <li><a href="../classes/TAG.Util.IdleTimer.html">TAG.Util.IdleTimer</a></li>
            
                <li><a href="../classes/TAG_embed.html">TAG_embed</a></li>
            
                <li><a href="../classes/Telemetry.html">Telemetry</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: TAG/js/Autolinker.js-master/src/Autolinker.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @class Autolinker
 * @extends Object
 * @singleton
 * 
 * Singleton class which exposes the {@link #link} method, used to process a given string of text,
 * and wrap the URLs, email addresses, and Twitter handles in the appropriate anchor (&amp;lt;a&amp;gt;) tags.
 */
var Autolinker = {
	
	// NOTE: The matcherRegex will be included after the class, from the compiled regex source
	
	
	/**
	 * @private
	 * @property {RegExp} htmlRegex
	 * 
	 * A regular expression used to pull out HTML tags from a string.
	 * 
	 * Capturing groups:
	 * 
	 * 1. If it is an end tag, this group will have the &#x27;/&#x27;.
	 * 2. The tag name.
	 */
	htmlRegex : /&lt;(\/)?(\w+)(?:(?:\s+\w+(?:\s*=\s*(?:&quot;.*?&quot;|&#x27;.*?&#x27;|[^&#x27;&quot;&gt;\s]+))?)+\s*|\s*)\/?&gt;/g,


	/**
	 * @private
	 * @property {RegExp} prefixRegex
	 * 
	 * A regular expression used to remove the &#x27;http://&#x27; or &#x27;https://&#x27; and/or the &#x27;www.&#x27; from URLs.
	 */
	prefixRegex: /^(https?:\/\/)?(www\.)?/,
	
	
	/**
	 * Automatically links URLs, email addresses, and Twitter handles found in the given chunk of HTML. 
	 * Does not link URLs found within HTML tags.
	 * 
	 * For instance, if given the text: &#x60;You should go to http://www.yahoo.com&#x60;, then the result
	 * will be &#x60;You should go to &amp;lt;a href=&quot;http://www.yahoo.com&quot;&amp;gt;http://www.yahoo.com&amp;lt;/a&amp;gt;&#x60;
	 * 
	 * @method link
	 * @param {String} html The HTML text to link URLs within.
	 * @param {Object} [options] Any options for the autolinking, specified in an object. It may have the following properties:
	 * @param {Boolean} [options.newWindow=true] True if the links should open in a new window, false otherwise.
	 * @param {Boolean} [options.stripPrefix=true] True if &#x27;http://&#x27; or &#x27;https://&#x27; and/or the &#x27;www.&#x27; should be stripped from the beginning of links, false otherwise.
	 * @param {Number} [options.truncate] A number for how many characters long URLs/emails/twitter handles should be truncated to
	 *   inside the text of a link. If the URL/email/twitter is over the number of characters, it will be truncated to this length by 
	 *   adding a two period ellipsis (&#x27;..&#x27;) into the middle of the string.
	 *   Ex: a url like &#x27;http://www.yahoo.com/some/long/path/to/a/file&#x27; truncated to 25 characters might look like this: &#x27;http://www...th/to/a/file&#x27;
	 * @param {Boolean} [options.twitter=true] True if Twitter handles (&quot;@example&quot;) should be automatically linked.
	 * @param {Boolean} [options.email=true] True if email addresses should be automatically linked.
	 * @param {Boolean} [options.urls=true] True if miscellaneous URLs should be automatically linked.
	 * @return {String} The HTML text, with URLs automatically linked
	 */
	link : function( html, options ) {
		options = options || {};
		
		var htmlRegex = Autolinker.htmlRegex,         // full path for friendly
		    matcherRegex = Autolinker.matcherRegex,   // out-of-scope calls
		    newWindow = ( &#x27;newWindow&#x27; in options ) ? options.newWindow : true,  // defaults to true
		    stripPrefix = ( &#x27;stripPrefix&#x27; in options ) ? options.stripPrefix : true,  // defaults to true
		    truncate = options.truncate,
		    enableTwitter = ( &#x27;twitter&#x27; in options ) ? options.twitter : true,  // defaults to true
		    enableEmailAddresses = ( &#x27;email&#x27; in options ) ? options.email : true,  // defaults to true
		    enableUrls = ( &#x27;urls&#x27; in options ) ? options.urls : true,  // defaults to true
		    currentResult, 
		    lastIndex = 0,
		    inBetweenTagsText,
		    resultHtml = &quot;&quot;,
		    anchorTagStackCount = 0;
		
		// Function to process the text that lies between HTML tags. This function does the actual wrapping of
		// URLs with anchor tags.
		function autolinkText( text ) {
			text = text.replace( matcherRegex, function( matchStr, $1, $2, $3, $4, $5 ) {
				var twitterMatch = $1,
				    twitterHandlePrefixWhitespaceChar = $2,  // The whitespace char before the @ sign in a Twitter handle match. This is needed because of no lookbehinds in JS regexes
				    twitterHandle = $3,  // The actual twitterUser (i.e the word after the @ sign in a Twitter handle match)
				    emailAddress = $4,   // For both determining if it is an email address, and stores the actual email address
				    urlMatch = $5,       // The matched URL string
					
				    prefixStr = &quot;&quot;,      // A string to use to prefix the anchor tag that is created. This is needed for the Twitter handle match
				    suffixStr = &quot;&quot;,      // A string to suffix the anchor tag that is created. This is used if there is a trailing parenthesis that should not be auto-linked.
					
				    anchorAttributes = [];
				
				// Handle a closing parenthesis at the end of the match, and exclude it if there is not a matching open parenthesis
				// in the match. This handles cases like the string &quot;wikipedia.com/something_(disambiguation)&quot; (which should be auto-
				// linked, and when it is enclosed in parenthesis itself, such as: &quot;(wikipedia.com/something_(disambiguation))&quot; (in
				// which the outer parens should *not* be auto-linked.
				var lastChar = matchStr.charAt( matchStr.length - 1 );
				if( lastChar === &#x27;)&#x27; ) {
					var openParensMatch = matchStr.match( /\(/g ),
						closeParensMatch = matchStr.match( /\)/g ),
						numOpenParens = ( openParensMatch &amp;&amp; openParensMatch.length ) || 0,
						numCloseParens = ( closeParensMatch &amp;&amp; closeParensMatch.length ) || 0;
					
					if( numOpenParens &lt; numCloseParens ) {
						matchStr = matchStr.substr( 0, matchStr.length - 1 );  // remove the trailing &quot;)&quot;
						suffixStr = &quot;)&quot;;  // this will be added after the &lt;a&gt; tag
					}
				}
				
				
				var anchorHref = matchStr,  // initialize both of these
					anchorText = matchStr;  // values as the full match

				if( ( twitterMatch &amp;&amp; !enableTwitter ) || ( emailAddress &amp;&amp; !enableEmailAddresses ) || ( urlMatch &amp;&amp; !enableUrls ) ) {
					// A disabled link type
					return prefixStr + anchorText + suffixStr;
				}
				
				// Process the urls that are found. We need to change URLs like &quot;www.yahoo.com&quot; to &quot;http://www.yahoo.com&quot; (or the browser
				// will try to direct the user to &quot;http://jux.com/www.yahoo.com&quot;), and we need to prefix &#x27;mailto:&#x27; to email addresses.
				if( twitterMatch ) {
					prefixStr = twitterHandlePrefixWhitespaceChar;
					anchorHref = &#x27;https://twitter.com/&#x27; + twitterHandle;
					anchorText = &#x27;@&#x27; + twitterHandle;
				
				} else if( emailAddress ) {
					anchorHref = &#x27;mailto:&#x27; + emailAddress;
					anchorText = emailAddress;
				
				} else if( !/^[A-Za-z]{3,9}:/i.test( anchorHref ) ) {  // string doesn&#x27;t begin with a protocol, add http://
					anchorHref = &#x27;http://&#x27; + anchorHref;
				}

				if( stripPrefix ) {
					anchorText = anchorText.replace( Autolinker.prefixRegex, &#x27;&#x27; );
				}

				// remove trailing slash
				if( anchorText.charAt( anchorText.length - 1 ) === &#x27;/&#x27; ) {
					anchorText = anchorText.slice( 0, -1 );
				}
				
				// Set the attributes for the anchor tag
				anchorAttributes.push( &#x27;href=&quot;&#x27; + anchorHref + &#x27;&quot;&#x27; );
				if( newWindow ) {
					anchorAttributes.push( &#x27;target=&quot;_blank&quot;&#x27; );
				}
				
				// Truncate the anchor text if it is longer than the provided &#x27;truncate&#x27; option
				if( truncate &amp;&amp; anchorText.length &gt; truncate ) {
					anchorText = anchorText.substring( 0, truncate - 2 ) + &#x27;..&#x27;;
				}
				
				return prefixStr + &#x27;&lt;a &#x27; + anchorAttributes.join( &quot; &quot; ) + &#x27;&gt;&#x27; + anchorText + &#x27;&lt;/a&gt;&#x27; + suffixStr;  // wrap the match in an anchor tag
			} );
			
			return text;
		}
		
		
		// Loop over the HTML string, ignoring HTML tags, and processing the text that lies between them,
		// wrapping the URLs in anchor tags 
		while( ( currentResult = htmlRegex.exec( html ) ) !== null ) {
			var tagText = currentResult[ 0 ],
			    tagName = currentResult[ 2 ],
			    isClosingTag = !!currentResult[ 1 ];
			
			inBetweenTagsText = html.substring( lastIndex, currentResult.index );
			lastIndex = currentResult.index + tagText.length;
			
			// Process around anchor tags, and any inner text / html they may have
			if( tagName === &#x27;a&#x27; ) {
				if( !isClosingTag ) {  // it&#x27;s the start &lt;a&gt; tag
					anchorTagStackCount++;
					resultHtml += autolinkText( inBetweenTagsText );
					
				} else {     // it&#x27;s the end &lt;/a&gt; tag
					anchorTagStackCount--;	
					if( anchorTagStackCount === 0 ) {
						resultHtml += inBetweenTagsText;  // We hit the matching &lt;/a&gt; tag, simply add all of the text from the start &lt;a&gt; tag to the end &lt;/a&gt; tag without linking it
					}
				}
				
			} else if( anchorTagStackCount === 0 ) {   // not within an anchor tag, link the &quot;in between&quot; text
				resultHtml += autolinkText( inBetweenTagsText );
			}
			
			resultHtml += tagText;  // now add the text of the tag itself verbatim
		}
		
		// Process any remaining text after the last HTML element. Will process all of the text if there were no HTML elements.
		if( lastIndex &lt; html.length ) {
			resultHtml += autolinkText( html.substring( lastIndex ) );
		}
		
		return resultHtml;
	}

};

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
